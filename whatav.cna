#author:	studycat
#blog:		https://www.cnblogs.com/studycat
#github:	https://github.com/StudyCat404
#teston:	CS 4.0 & Windows
#update: 	20201129

$db = %(
    ALYac => %( processes => @("aylaunch.exe","ayupdate2.exe","AYRTSrv.exe","AYAgent.exe",), url => "https://en.estsecurity.com/"),
    AVG => %( processes => @("AVGSvc.exe","AVGUI.exe","avgwdsvc.exe","avg.exe","avgaurd.exe","avgemc.exe","avgrsx.exe","avgserv.exe","avgw.exe",), url => "https://www.avg.com/"),
    Acronis => %( processes => @("arsm.exe","acronis_license_service.exe",), url => "https://www.acronis.com/"),
    Ad-Aware => %( processes => @("AdAwareService.exe","Ad-Aware.exe","AdAware.exe",), url => "https://www.adaware.com/"),
    AhnLab-V3 => %( processes => @("patray.exe","V3Svc.exe",), url => "https://global.ahnlab.com/site/main.do"),
    Arcabit => %( processes => @("arcavir.exe","arcadc.exe","ArcaVirMaster.exe","ArcaMainSV.exe","ArcaTasksService.exe",), url => "https://www.arcabit.pl"),
    Avast => %( processes => @("ashDisp.exe","AvastUI.exe","AvastSvc.exe","AvastBrowser.exe","AfwServ.exe",), url => "https://www.avast.com"),
    Avira AntiVirus => %( processes => @("avcenter.exe","avguard.exe","avgnt.exe","sched.exe",), url => "https://www.avira.com/"),
    Baidu Antivirus => %( processes => @("BaiduSdSvc.exe","BaiduSdTray.exe","BaiduSd.exe","bddownloader.exe","baiduansvx.exe",), url => "https://anquan.baidu.com/"),
    BitDefender => %( processes => @("Bdagent.exe","BitDefenderCom.exe","vsserv.exe","bdredline.exe","bdservicehost.exe",), url => "http://www.bitdefender.com/"),
    Bkav => %( processes => @("BKavService.exe","Bka.exe","BkavUtil.exe","BLuPro.exe",), url => "https://www.bkav.com/"),
    CAT-QuickHeal => %( processes => @("QUHLPSVC.exe","onlinent.exe","sapissvc.exe","scanwscs.exe",), url => "https://www.quickheal.com/"),
    ClamAV => %( processes => @("freshclam.exe",), url => "https://www.clamav.net"),
    Comodo => %( processes => @("cpf.exe","cavwp.exe","ccavsrv.exe","cmdvirth.exe",), url => "https://www.comodo.com"),
    CrowdStrike Falcon => %( processes => @("csfalconservice.exe","CSFalconContainer.exe",), url => "https://www.crowdstrike.com"),
    Cybereason => %( processes => @("CybereasonRansomFree.exe","CybereasonRansomFreeServiceHost.exe","CybereasonAV.exe",), url => "https://www.cybereason.com/"),
    Cylance => %( processes => @("CylanceSvc.exe",), url => "https://www.cylance.com"),
    Cyren => %( processes => @("vsedsps.exe","vseamps.exe","vseqrts.exe",), url => "http://www.cyren.com/"),
    DrWeb => %( processes => @("drwebcom.exe","spidernt.exe","drwebscd.exe","drweb32w.exe","dwengine.exes",), url => "https://www.drweb.com/"),
    ESET-NOD32 => %( processes => @("egui.exe","ecls.exe","ekrn.exe","eguiProxy.exe","EShaSrv.exe",), url => "https://www.eset.com/us/home/antivirus/"),
    Emsisoft => %( processes => @("a2cmd.exe","a2guard.exe",), url => "https://www.emsisoft.com/"),
    Endgame => %( processes => @("endgame.exe",), url => "https://www.endgame.com/"),
    F-Prot => %( processes => @("F-PROT.exe","FProtTray.exe","FPAVServer.exe","f-stopw.exe","f-prot95.exe","f-agnt95.exe",), url => "http://f-prot.com/"),
    F-Secure => %( processes => @("f-secure.exe","fssm32.exe","Fsorsp64.exe","fsavgui.exe","fameh32.exe","fch32.exe","fih32.exe","fnrb32.exe","fsav32.exe","fsma32.exe","fsmb32.exe",), url => "https://www.f-secure.com"),
    FireEye => %( processes => @("xagtnotif.exe","xagt.exe",), url => "https://www.fireeye.com/"),
    Fortinet => %( processes => @("FortiClient.exe","FortiTray.exe","FortiScand.exe",), url => "https://fortiguard.com/"),
    GData => %( processes => @("AVK.exe","avkcl.exe","avkpop.exe","avkservice.exe","GDScan.exe","AVKWCtl.exe","AVKProxy.exe","AVKBackupService.exe",), url => "https://www.gdatasoftware.com/"),
    Ikarus => %( processes => @("guardxservice.exe","guardxkickoff.exe",), url => "https://www.ikarussecurity.com/"),
    Jiangmin => %( processes => @("KVFW.exe","KVsrvXP.exe","KVMonXP.exe","KVwsc.exe",), url => "https://www.jiangmin.com/"),
    K7AntiVirus => %( processes => @("K7TSecurity.exe","K7TSMain.Exe","K7TSUpdT.exe",), url => "http://viruslab.k7computing.com/"),
    Kaspersky => %( processes => @("avp.exe","avpcc.exe","avpm.exe","kavpf.exe","kavfs.exe","klnagent.exe","kavtray.exe","kavfswp.exe",), url => "https://www.kaspersky.com"),
    Kingsoft => %( processes => @("kxetray.exe","ksafe.exe","KSWebShield.exe","kpfwtray.exe","KWatch.exe","KSafeSvc.exe","KSafeTray.exe",), url => "http://www.duba.net/"),
    Max Secure Software => %( processes => @("SDSystemTray.exe","MaxRCSystemTray.exe","RCSystemTray.exe",), url => "https://www.maxpcsecure.com/"),
    Malwarebytes => %( processes => @("MBAMService.exe","mbam.exe","mbamtray.exe",), url => "https://www.malwarebytes.com/"),
    McAfee => %( processes => @("Mcshield.exe","Tbmon.exe","Frameworkservice.exe","firesvc.exe","firetray.exe","hipsvc.exe","mfevtps.exe","mcafeefire.exe","shstat.exe","vstskmgr.exe","engineserver.exe","alogserv.exe","avconsol.exe","cmgrdian.exe","cpd.exe","mcmnhdlr.exe","mcvsshld.exe","mcvsrte.exe","mghtml.exe","mpfservice.exe","mpfagent.exe","mpftray.exe","vshwin32.exe","vsstat.exe","guarddog.exe",), url => "https://www.mcafee.com/en-us"),
    Microsoft security essentials => %( processes => @("MsMpEng.exe","mssecess.exe","emet_service.exe","drwatson.exe","MpCmdRun.exe","NisSrv.exe","MsSense.exe","MSASCui.exe","MSASCuiL.exe","SecurityHealthService.exe",), url => "https://support.microsoft.com/en-us/help/17150/windows-7-what-is-microsoft-security-essentials"),
    NANO-Antivirus => %( processes => @("nanoav.exe","nanoav64.exe","nanoreport.exe","nanoreportc.exe","nanoreportc64.exe","nanorst.exe","nanosvc.exe",), url => "https://nano-av.com/"),
    a-squared free => %( processes => @("a2guard.exe","a2free.exe","a2service.exe",), url => "https://baike.baidu.com/item/a-squared%20Free/481873?fr=aladdin"),
    Palo Alto Networks => %( processes => @("PanInstaller.exe",), url => "https://www.paloaltonetworks.com/"),
    Panda Security => %( processes => @("remupd.exe","apvxdwin.exe","pavproxy.exe","pavsched.exe",), url => "https://www.pandasecurity.com/"),
    Qihoo-360 => %( processes => @("360sd.exe","360tray.exe","ZhuDongFangYu.exe","360rp.exe","360safe.exe","360safebox.exe","QHActiveDefense.exe","360skylarsvc.exe","LiveUpdate360.exe",), url => "https://sd.360.cn/"),
    Rising => %( processes => @("RavMonD.exe","rfwmain.exe","RsMgrSvc.exe",), url => "http://antivirus.rising.com.cn/"),
    SUPERAntiSpyware => %( processes => @("superantispyware.exe","sascore.exe","SAdBlock.exe","sabsvc.exe",), url => "http://www.superadblocker.com/"),
    SecureAge APEX => %( processes => @("UniversalAVService.exe","EverythingServer.exe","clamd.exe",), url => "https://www.secureage.com/"),
    SentinelOne (Static ML) => %( processes => @(), url => "https://www.sentinelone.com/"),
    Sophos AV => %( processes => @("SavProgress.exe","SophosUI.exe","SophosFS.exe","SophosHealth.exe","SophosSafestore64.exe","SophosCleanM.exe","icmon.exe","SavMain.exe",), url => "https://www.sophos.com/"),
    Symantec => %( processes => @("ccSetMgr.exe","ccapp.exe","vptray.exe","ccpxysvc.exe","cfgwiz.exe","smc.exe","symproxysvc.exe","vpc32.exe","lsetup.exe","luall.exe","lucomserver.exe","sbserv.exe","ccEvtMgr.exe",), url => "http://www.symantec.com/"),
    TACHYON => %( processes => @(), url => "https://www.tachyonlab.com/en/index.html"),
    Tencent => %( processes => @("QQPCRTP.exe","QQPCTray.exe","QQPCMgr.exe","QQPCNetFlow.exe","QQPCRealTimeSpeedup.exe",), url => "https://guanjia.qq.com"),
    TotalDefense => %( processes => @("AMRT.exe","SWatcherSrv.exe","Prd.ManagementConsole.exe",), url => "https://www.totaldefense.com"),
    Trapmine => %( processes => @("TrapmineEnterpriseService.exe","TrapmineEnterpriseConfig.exe","TrapmineDeployer.exe","TrapmineUpgradeService.exe",), url => "https://trapmine.com/"),
    TrendMicro => %( processes => @("TMBMSRV.exe","ntrtscan.exe","Pop3Trap.exe","WebTrap.exe","PccNTMon.exe",), url => "http://careers.trendmicro.com.cn/"),
    VIPRE => %( processes => @("SBAMSvc.exe","VipreEdgeProtection.exe","SBAMTray.exe",), url => "https://www.vipre.com"),
    ViRobot => %( processes => @("vrmonnt.exe","vrmonsvc.exe","Vrproxyd.exe",), url => "http://www.hauri.net/"),
    Webroot => %( processes => @("npwebroot.exe","WRSA.exe","spysweeperui.exe",), url => "https://www.webroot.com/us/en"),
    Yandex => %( processes => @("Yandex.exe","YandexDisk.exe","yandesk.exe",), url => "https://yandex.com/support/common/security/antiviruses-free.html"),
    Zillya => %( processes => @("zillya.exe","ZAVAux.exe","ZAVCore.exe",), url => "https://zillya.com"),
    ZoneAlarm => %( processes => @("vsmon.exe","zapro.exe","zonealarm.exe",), url => "https://www.zonealarm.com/"),
    Zoner => %( processes => @("ZPSTray.exe",), url => "https://zonerantivirus.com/"),
    eGambit => %( processes => @("dasc.exe","dastray.exe","memscan64.exe","dastray.exe",), url => "https://egambit.app/en/"),
    eScan => %( processes => @("consctl.exe","mwaser.exe","avpmapp.exe",), url => "https://www.escanav.com/"),
    Lavasoft => %( processes => @("AAWTray.exe","LavasoftTcpService.exe","AdAwareTray.exe","WebCompanion.exe","WebCompanionInstaller.exe","adawarebp.exe",), url => "https://www.lavasoft.com/"),
    The Cleaner => %( processes => @("cleaner8.exe",), url => ""),
    VBA32 => %( processes => @("vba32lder.exe",), url => "http://www.anti-virus.by/en/index.shtml"),
    Mongoosa => %( processes => @("MongoosaGUI.exe","mongoose.exe",), url => "https://www.securitymongoose.com/"),
    Coranti2012 => %( processes => @("CorantiControlCenter32.exe",), url => "https://www.coranti.com"),
    UnThreat => %( processes => @("UnThreat.exe","utsvc.exe",), url => "https://softplanet.com/UnThreat-AntiVirus"),
    Shield Antivirus => %( processes => @("CKSoftShiedAntivirus4.exe","shieldtray.exe",), url => "https://shieldapps.com/supportmain/shield-antivirus-support/"),
    VIRUSfighter => %( processes => @("AVWatchService.exe","vfproTray.exe",), url => "https://www.spamfighter.com/VIRUSfighter/"),
    Immunet => %( processes => @("iptray.exe",), url => "https://www.immunet.com/index"),
    PSafe => %( processes => @("PSafeSysTray.exe","PSafeCategoryFinder.exe","psafesvc.exe",), url => "https://www.psafe.com/"),
    nProtect => %( processes => @("nspupsvc.exe","Npkcmsvc.exe","npnj5Agent.exe",), url => "http://nos.nprotect.com/"),
    Spyware Terminator => %( processes => @("SpywareTerminatorShield.exe","SpywareTerminator.exe",), url => "http://www.spywareterminator.com/Default.aspx"),
    Norton => %( processes => @("ccSvcHst.exe","rtvscan.exe","ccapp.exe","NPFMntor.exe","ccRegVfy.exe","vptray.exe","iamapp.exe","nav.exe","navapw32.exe","navapsvc.exe","nisum.exe","nmain.exe","nprotect.exe","smcGui.exe",), url => "https://us.norton.com/"),
    Safedog => %( processes => @("safedog.exe","SafeDogGuardCenter.exe","safedogupdatecenter.exe","safedogguardcenter.exe","SafeDogSiteIIS.exe","SafeDogTray.exe","SafeDogServerUI.exe",), url => "http://www.safedog.cn/"),
    micropoint => %( processes => @("MPMon.exe",), url => "http://www.micropoint.com.cn/"),
    D Safe => %( processes => @("D_Safe_Manage.exe","d_manage.exe",), url => "http://www.d99net.net/"),
    Yunsuo => %( processes => @("yunsuo_agent_service.exe","yunsuo_agent_daemon.exe",), url => "https://www.yunsuo.com.cn/"),
    HWS => %( processes => @("HwsPanel.exe","hws_ui.exe","hws.exe","hwsd.exe",), url => "https://www.hws.com/"),
    Huorong => %( processes => @("hipstray.exe","wsctrl.exe","usysdiag.exe","HipsDaemon.exe","HipsLog.exe","HipsMain.exe","usysdiag.exe","wsctrl.exe",), url => ""),
    SPHINX firewall => %( processes => @("SPHINX.exe",), url => ""),
    Enhanced Mitigation Experience Toolkit => %( processes => @("emet_agent.exe","emet_service.exe",), url => "https://support.microsoft.com/en-us/help/2458544/the-enhanced-mitigation-experience-toolkit"),
    H+BEDV Datentechnik GmbH => %( processes => @("avwin.exe","avwupsrv.exe",), url => "http://www.free-av.com/"),
    IBM ISS Proventia => %( processes => @("blackd.exe","rapapp.exe",), url => ""),
    eEye Digital Security => %( processes => @("eeyeevnt.exe","blink.exe",), url => ""),
    TamoSoft => %( processes => @("cv.exe","ent.exe",), url => "https://www.tamos.com/"),
    Kerio Personal Firewall => %( processes => @("persfw.exe","wrctrl.exe",), url => "http://www.kerio.com/"),
    Simplysup => %( processes => @("Trjscan.exe",), url => "https://www.simplysup.com/"),
    PC Tools AntiVirus => %( processes => @("PCTAV.exe","pctsGui.exe",), url => "http://www.pctools.com"),
    VirusBuster Professional => %( processes => @("vbcmserv.exe",), url => "http://www.virusbuster.hu"),
    ClamWin => %( processes => @("ClamTray.exe","clamscan.exe",), url => "http://www.clamwin.com/"),
    Antiy-AVL => %( processes => @("kxetray.exe","kscan.exe","AMediumManager.exe","kismain.exe",), url => "https://antiy.cn/"),
    CMC => %( processes => @("CMCTrayIcon.exe","CMCNECore.exe","cmcepagent.exe","cmccore.exe","CMCLog.exe","CMCFMon.exe",), url => "https://cmccybersecurity.com/giai-phap/"),
    Kingsoft => %( processes => @("kxescore.exe","kupdata.exe","kxetray.exe","kwsprotect64.exe",), url => "http://www.ijinshan.com/"),
    Agnitum outpost => %( processes => @("outpost.exe","acs.exe",), url => "https://agnitum-outpost-security-suite.en.softonic.com/"),
);
	
command foo {
	println($db)
}

alias("whatav", {
	bps($1, &bwhatav);
});

sub bwhatav {
	local('$flag $h1 $h2 $h3');
	$flag = 0;
	@array = @("test");
	
	$a = split("\n",$2);
	foreach $entry ($a){
		$b = split("\t",$entry);
		if ($b[0] in @array){
			#pass
		}else{
			add(@array, $b[0]);
		}
	}
	
	$h1 = "Antivirus";
	$h2 = "Process";
	$h3 = "URL";
	blog2($1, "$[20]h1 $[20]h2 $h3");
	
	foreach $t (@array){
		foreach $var (keys($db)){
			foreach $p ($db[$var]["processes"]){
				$url = $db[$var]['url'];
				if (lc($p) eq lc($t)){
					$flag = 1;
					blog2($1, "\c7$[20]var $[20]t $url");
					break;
				}
			}
		}
	}
	
	if ($flag < 1){
		blog2($1, "\c3No Antivirus found!");
	}
}